# 开发流程与日程计划

## 1. 开发流程（分阶段操作清单）

### A. 准备与架构定稿
1. 冻结 MVP 范围：上传解析 → Skill → 功能创建 → 发布固化 → 调用 → 权限/审核 → 运行监控 → 成本面板。
2. 技术选型：前端（React/Vue+TS）；后端主中台（Node/Python/Java 三选一）+ 多运行时执行池；容器/编排（Docker+K8s/Compose）；队列（Kafka/RabbitMQ）；DB（PostgreSQL+Redis）；是否需要对象存储（如仅临时可用内存/本地临时+定时清理）。
3. 多运行时方案：Python/Node/Java 容器镜像规范、资源配额、冷启动预热策略。
4. 安全基线：零原文件存储、日志脱敏、API 密钥管理、审计日志要求。
5. 研发流程：分支策略（main + feature）、PR/CR 规则、CI 要求。

### B. 环境与基础设施
1. 仓库初始化：前后端/执行引擎仓库（单仓 mono 或前后分仓）。
2. CI/CD：lint/test/build、容器构建、镜像推送、本地/测试部署流水线。
3. 基础镜像：Python/Node/Java 运行时镜像制作与预热脚本。
4. 本地/测试环境：`.env` 模板，HTTPS/证书，API 密钥占位。
5. K8s/Compose：API 网关、主后端、调度器、运行时池、DB、Redis、MQ。

### C. 基础能力搭建
1. 认证与权限：角色（项目/部门/系统）、权限矩阵、Token/SSO 对接。
2. 零存储管线：上传→解析→提取→临时存储→清理，中间件确保不落盘。
3. Skill 服务：CRUD、版本、标签、引用关系。
4. Function 模型：运行时语言、依赖、资源配额、IO 定义、版本、固化状态。
5. 审核流：发布/修改/下架申请→审批→审计日志。

### D. 功能执行引擎（多语言）
1. 统一接口：execute(input, context) 模板（Python/Node/Java）。
2. 调度器：语言匹配、负载均衡、优先级、亲和性；对接任务队列。
3. 运行时池：容器预热、健康检查、失败重启、资源限制、超时/并发限制。
4. 日志/指标：执行日志收集、耗时 P95、错误率、冷启动统计。
5. 安全：网络白名单、FS 沙箱、系统调用限制、敏感信息过滤。

### E. 前端主要页面
1. 登录/SSO，工作台。
2. 文档上传页：步骤进度、格式/大小校验、提取预览、人工标注、生成 Skill。
3. Skill 管理：表格、筛选、详情抽屉、版本/引用/审计。
4. 功能开发向导：步骤条、运行时选择、IO 定义、依赖、代码编辑器、测试。
5. 功能管理/市场：列表、筛选、详情（版本、调用示例、统计）、新版本/申请修改/下架。
6. 权限与审核：待办列表、差异对比、审批操作。
7. 运行与监控：运行时池状态、任务队列、耗时/错误率图表、告警。
8. 成本与统计：调用/成本趋势、配额进度、模型分布。
9. 个人中心/密钥管理：密钥轮换、偏好、2FA。

### F. 测试与验收
1. 单测：后端、执行器、权限、零存储清理。
2. 集成：上传-提取-Skill-功能-发布-调用全链路；多语言执行验证。
3. 安全：无原文件残留、日志脱敏、权限绕过、API 密钥保护。
4. 性能：冷启动、P95、并发、队列积压、资源回收。
5. 灰度/预发布：小范围用户试用，收集反馈。

### G. 上线与运维
1. 部署：生产参数、镜像、密钥注入、域名/HTTPS。
2. 监控告警：指标阈值、日志采集、告警路由。
3. 备份/恢复演练：DB 快照、配置备份。
4. 运营面板：调用量、成本预警、配额管理。
5. 文档移交：使用手册、API 文档、运维手册。

---

## 2. 日程计划（示例 6 周，按工作日）

### 周1：需求/架构/基础设施
- 周一：范围确认，MVP 冻结；角色/权限矩阵定稿。
- 周二：技术栈与多运行时方案定稿；仓库/分支策略确定。
- 周三：CI/CD 框架（lint/test/build），容器仓库配置。
- 周四：运行时基础镜像（Py/Node/Java）制作，预热脚本；K8s/Compose 雏形。
- 周五：零存储策略、日志脱敏、密钥管理、安全基线文档。

### 周2：后端基础 & 权限/Skill/Function 模型
- 周一：认证/授权骨架（SSO 占位、JWT/Session），权限拦截。
- 周二：数据模型落库：User/Project/Dept/Function/Skill/Share/UsageLog/ExecutionTask。
- 周三：Skill 服务 CRUD、版本、标签、引用；审计日志基础。
- 周四：Function 服务 CRUD（运行时、依赖、IO 定义、资源配额、固化状态）；发布=固化规则。
- 周五：审核流框架（申请/审批/审计）；API 网关限流/路由雏形。

### 周3：执行引擎（多语言） & 零存储管线
- 周一：上传-解析-提取-清理管线（不落盘），格式/大小校验。
- 周二：执行器统一接口；Py/Node/Java 运行时模板。
- 周三：任务队列与调度器（语言匹配、负载均衡、优先级、超时/并发限制）。
- 周四：运行时池：预热、健康检查、失败重启、资源配额；日志/指标采集。
- 周五：安全加固：网络白名单、FS 沙箱、敏感信息过滤、执行超时/内存限制。

### 周4：前端核心页面（1/2）+ 后端对接
- 周一：UI 体系（主题/组件库）；登录/工作台骨架。
- 周二：文档上传页：步骤进度、URL/文件上传、提取预览、生成 Skill。
- 周三：Skill 管理页：列表、筛选、详情抽屉、版本/引用/审计。
- 周四：功能开发向导：步骤条、基础信息、运行时、IO 定义、依赖上传、代码编辑器。
- 周五：功能开发页测试运行对接后端（同步/异步），结果/日志/耗时展示。

### 周5：前端核心页面（2/2）+ 权限/审核/监控
- 周一：功能管理/市场列表与详情（版本历史、调用示例 REST/WS/SSE、统计）。
- 周二：权限与审核中心：待办列表、差异对比、审批操作；无权限灰显提示。
- 周三：运行与监控：运行时池状态、任务队列、耗时/错误率图表、告警列表。
- 周四：成本与统计：调用/成本趋势、配额进度、模型分布、优化提示。
- 周五：个人中心/密钥管理：密钥轮换、偏好、2FA；整体前后端联调。

### 周6：测试、性能、安全、灰度、上线
- 周一：单测/集成补齐；全链路回归（上传→Skill→功能→发布→调用）。
- 周二：性能压测（冷启动、P95、并发、队列积压）；运行时池预热调优。
- 周三：安全测试（无原文件残留、日志脱敏、权限绕过、密钥保护）；修复。
- 周四：灰度/预发布，收集反馈；成本监控校验。
- 周五：正式上线；监控告警复核；编写/更新使用、API、运维手册。

---

## 3. 每日执行要点
- 开发前：拉主干，建 feature 分支；看板更新；确认待审/阻塞。
- 开发中：先定接口契约（OpenAPI/DTO），先测后码；PR 及时提交。
- 联调：固定测试数据+Mock；记录接口耗时与错误。
- 日终：记录 PR 状态、已知问题、次日阻塞；检查 CI。
- 周节奏：周三/周五固定 Review；每周轻量性能/安全回归一次。

---

## 4. 资源与角色建议
- 前端：2 人（页面/交互/表格&图表/调用示例组件）。
- 后端：2-3 人（主 API、权限/审核、零存储管线、统计）。
- 执行引擎：1-2 人（调度、容器池、运行时安全/性能）。
- QA：1 人（功能+安全+性能）；DevOps：1 人（CI/CD、监控、部署）。

> 如需压缩周期或按人力重新分配，请提供团队规模和发布日期。

